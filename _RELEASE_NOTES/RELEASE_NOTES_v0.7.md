# リリースノート - Version 0.7

2026/01/08

## Version 0.7

### UIデザイン刷新

- **ヘッダー・フッターのフローティング化**
  - 背景を透明に変更
  - ボタンは半透明白背景で独立したフローティング要素に
  - コンテンツの上下移動が発生しないレイアウト
  - ヘッダー: 右上に配置
  - フッター: 中央下に配置
  - ツールバートグルボタン: 右下に配置

- **ボタンスタイルの統一**
  - 半透明白背景（`rgba(255, 255, 255, 0.9)`）
  - 軽いボーダーとシャドウ
  - 角丸デザイン（ナビボタン・検索フィールドは`border-radius: 20px`）
  - ヘッダーボタン（Aa等）を正方形に統一（32px × 32px）

- **フッター要素の高さ統一**
  - Rボタン、検索フィールド、前の詩歌/次の詩歌を同じ高さに
  - デスクトップ: 36px / モバイル: 32px

- **サイドバーのデフォルト非表示**
  - 初回表示時はサイドバーを閉じた状態に
  - トグルボタンまたは`R`キーで開閉

- **ツールバートグルボタン**
  - 「フルスクリーン」から「ツールバー表示/非表示」に改名
  - アイコン: ☰（表示時）/ ☰に斜め線（非表示時、3本線は薄グレー、斜め線はミドルグレー）
  - ショートカット: `T`

- **検索結果トグルボタン（Rボタン）**
  - 三角形と(R)を横並びに表示
  - ピル型デザイン（`border-radius: 18px`）
  - ラベル: 「検索結果を開く/閉じる (R)」

- **検索結果プレビュー**
  - イタリック体から標準体に変更

### 新機能

- **設定の永続化**
  - 訳本表示設定（歌訳/全訳/中文の表示状態）をlocalStorageに保存
  - ページ再読み込み後も設定が維持される

- **ループナビゲーション**
  - 最初の詩歌で「前の詩歌」を押すと最後の詩歌へ
  - 最後の詩歌で「次の詩歌」を押すと最初の詩歌へ
  - ナビゲーションボタンは常に有効（グレーアウトしない）

- **新しいキーボードショートカット**
  - `I` ショートカット一覧ポップアップを表示
  - `T` ツールバー表示/非表示
  - `F` フォント切替（ゴシック→細長→明朝→ゴシック...）
  - `R` 検索結果(Result)の開閉

- **検索フィールドからの脱出**
  - `Esc`キーで検索フィールドからフォーカスを外せる

### レイアウト改善

- **横並び時のプレースホルダー**
  - ある訳本の節が存在しない場合でも、プレースホルダーでスペースを確保
  - 各訳本の列は常に左揃えを維持
  - レイアウトの崩れを防止

### アルゴリズム改善

- **余白最適化の強化**
  - より正確な必要幅計算（余裕を16px→2pxに削減）
  - 必要幅に比例した余白配分（短い訳本から余白を削り、長い訳本に優先配分）
  - 最小限のバッファのみ付与

### クロスプラットフォーム対応

- **Windowsフォント対応**
  - Yu Gothic、YuGothic、Meiryo、MS Gothicをフォールバックに追加
  - 明朝体にMS Minchoを追加

- **Windowsスクロールバー対応**
  - オーバーレイ風の細いスクロールバー（6px）
  - 半透明デザインでコンテンツの邪魔をしない

### キーボードショートカット一覧（更新）

| キー | 機能 |
|------|------|
| ← | 前の詩歌 |
| → | 次の詩歌 |
| J | 歌訳の表示/非表示 |
| Z | 全訳の表示/非表示 |
| C | 中文の表示/非表示 |
| L | レイアウト切替 |
| O | 余白最適化 |
| S | 検索 |
| R | 検索結果(Result)の開閉 |
| ↑ | フォント拡大 |
| ↓ | フォント縮小 |
| F | フォント切替 |
| W | ウェイト切替 |
| T | ツールバー表示/非表示 |
| I | ショートカット一覧(本メニュー) |

