# リリースノート - Version 0.3

2026/01/06

## Version 0.3

### 新機能
- **Progressive Web App (PWA) 対応**
  - Service Workerの実装によるオフライン機能
  - Web App Manifestの追加
  - アプリアイコンの作成（192x192、512x512）
  - PWA設定メニューに「PWAを有効化」と「Reset Cache」ボタンを追加
  - オフライン時もキャッシュされたリソースで動作可能

- **主要言語選択機能**
  - ヘッダーに地球マークボタンを追加
  - 日本語、中文、Englishの主要言語を選択可能
  - 選択した主要言語が最初（左側）に表示される
  - 主要言語の選択はlocalStorageに保存

- **歌訳ボタンの追加**
  - ヘッダーに「歌訳」ボタンを追加
  - ボタンの順番を「歌訳・全訳・中文・English」に統一
  - すべてのボタンのスタイルを統一（全訳と同じ色設定）

- **キーボードショートカット**
  - **Z**: 全訳の表示/非表示を切り替え
  - **C**: 中文の表示/非表示を切り替え
  - **J**: 日本語歌訳の表示/非表示を切り替え
  - 修飾キー（Ctrl、Alt、Shift、Meta）との組み合わせでは反応しないように修正

- **中国語の2行結合機能**
  - デスクトップ表示（768px以上）で中国語の歌詞を2行ずつ結合
  - 句読点がない場合は全角スペースを挟んで結合
  - 結合後に折り返しが発生する場合は結合を行わない

- **スタンザの幅自動調整機能**
  - 折り返しが発生しているスタンザを検出
  - 余裕があるスタンザから幅を動的に再配分
  - flex値を自動調整して折り返しを最小化

### UI改善
- 検索結果のプレビュー部分もクリック可能に（タイトルとプレビューを一つの要素として統合）
- 検索結果のプレビューを折り返さないように設定（`white-space: nowrap`）
- 検索フィールドのフォントサイズを16pxに設定（スマホでの自動ズームを防止）
- サイドメニュー開閉ボタンに「Esc」を小さな文字で表示
- 歌訳の左側に縦棒を追加（全訳と同様のスタイル）
- スマホ表示でサブの歌詞（主要言語以外）を一文字インデント
- 節番号のスタイルをすべての言語で統一
- ヘッダーの設定ボタン（Aa、🌐、⚙）を右寄せに配置
- 歯車アイコンをPWAを想起させるダウンロードアイコンに変更

### バグ修正
- 修飾キーと組み合わせたキーボードショートカットが誤ってトリガーされる問題を修正
- 中国語の2行結合で折り返しが発生する場合の処理を改善

